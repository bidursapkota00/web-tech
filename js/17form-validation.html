<html>
  <head>
    <title>Form Validation</title>
    <style>
      form {
        margin: 200px;
      }
      button {
        cursor: pointer;
      }
      .error {
        color: red;
        font-size: 14px;
        margin: 0;
      }
      .input_container {
        position: relative;
        padding-bottom: 15px;
        margin-bottom: 15px;
      }
      .error {
        position: absolute;
        bottom: 0;
        left: 0;
      }
    </style>
  </head>
  <body>
    <form action="/js/17form-validation.html" onsubmit="return validate();">
      <div class="input_container">
        <label for="name">Name: </label>
        <input type="text" id="name" name="name" placeholder="John Doe" />
        <p class="error" id="name_error"></p>
      </div>

      <div class="input_container">
        <label for="username">Username: </label>
        <input
          type="text"
          id="username"
          name="username"
          placeholder="john-doe-123"
        />
        <p class="error" id="username_error"></p>
      </div>

      <div class="input_container">
        <label for="email">Email: </label>
        <input
          type="email"
          id="email"
          name="email"
          placeholder="johndoe@email.com"
        />
        <p class="error" id="email_error"></p>
      </div>

      <div class="input_container">
        <label for="password">Password: </label>
        <input
          type="password"
          id="password"
          name="password"
          placeholder="********"
        />
        <p class="error" id="password_error"></p>
      </div>

      <button type="submit">Submit</button>
    </form>

    <script>
      function validate() {
        resetError();

        const name_tag = document.getElementById("name");
        const username_tag = document.getElementById("username");
        const email_tag = document.getElementById("email");
        const password_tag = document.getElementById("password");

        const name = name_tag.value.trim();
        const username = username_tag.value.trim();
        const email = email_tag.value.trim();
        const password = password_tag.value.trim();

        let errorBit = 0b0000;

        if (!name) {
          errorBit = errorBit | 0b1000;
          showError("name", "Name is required!");
        }
        if (!username) {
          errorBit = errorBit | 0b0100;
          showError("username", "Username is required!");
        }
        if (!email) {
          errorBit = errorBit | 0b0010;
          showError("email", "Email is required");
        }
        if (!password) {
          errorBit = errorBit | 0b0001;
          showError("password", "Password is required");
        }

        if (!(errorBit & 0b1000) && !/^[a-zA-Z]+(?: [a-zA-Z]+)+$/.test(name)) {
          showError("name", "Name is Invalid!");
          errorBit = errorBit | 0b1000;
        }
        if (!(errorBit & 0b0100) && !/^[a-zA-Z][a-zA-Z0-9-]+$/.test(username)) {
          showError("username", "Username is Invalid!");
          errorBit = errorBit | 0b0100;
        }

        if (
          !(errorBit & 0b0010) &&
          !/^[\w-\.]+@(?:[\w]+\.)+[\w]{2,4}$/.test(email)
        ) {
          showError("email", "Email is Invalid");
          errorBit = errorBit | 0b0010;
        }
        if (
          !(errorBit & 0b0001) &&
          !/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$/.test(
            password
          )
        ) {
          showError("password", "Password is Invalid");
          errorBit = errorBit | 0b0001;
        }

        if (errorBit) return false;

        return true;
      }

      function showError(error_tag_name, message) {
        switch (error_tag_name) {
          case "name":
            document.getElementById("name_error").textContent = message;
            break;

          case "username":
            document.getElementById("username_error").textContent = message;
            break;

          case "email":
            document.getElementById("email_error").textContent = message;
            break;

          case "password":
            document.getElementById("password_error").textContent = message;
            break;

          default:
            console.log("Something went wrong!");
            break;
        }
      }

      function resetError() {
        const errorTags = document.querySelectorAll(".error");
        for (const errorTag of errorTags) {
          errorTag.textContent = "";
        }
      }
    </script>
  </body>
</html>
